<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GitHub Visual Site Editor</title>
  <meta name="description" content="Visual editor for site copy and images stored in GitHub.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./editor.css">
</head>
<body>
  <div class="app">
    <main class="main">
      <section class="preview-panel">
        <div class="preview-header">
          <div>
            <h2>Live preview</h2>
            <p>Click text to edit. Links still navigate between pages.</p>
            <p class="hint-inline">Tip: turn off editing to avoid accidental selections.</p>
          </div>
          <div class="preview-actions">
            <button id="toggleEditBtn" class="btn ghost" type="button">Disable editing</button>
            <button id="deselectBtn" class="btn ghost" type="button">Deselect</button>
            <span id="editorBadge" class="badge">No edits</span>
          </div>
        </div>
        <div class="frame-wrap">
          <iframe id="previewFrame" title="Site preview" scrolling="yes"></iframe>
        </div>
      </section>

      <section class="preview-panel consultations-panel" data-consultations-panel>
        <div class="preview-header">
          <div>
            <h2>Consultation requests</h2>
            <p>Review incoming consultation applications.</p>
          </div>
          <div class="preview-actions">
            <button id="consultationsPageRefresh" class="btn ghost" type="button">Refresh</button>
          </div>
        </div>
        <div class="consultations-body">
          <div id="consultationsPageMessage" class="admin-message"></div>
          <div id="consultationsPageList" class="consult-admin-list"></div>
        </div>
      </section>
<aside class="sidebar">
        <section class="panel">
          <div class="panel-header">
            <h2>Connect</h2>
            <span class="status-chip" id="connectChip">Offline</span>
          </div>
          <div class="panel-body">
            <div class="stack">
            <label class="field">
              <span>Site URL</span>
              <input id="siteInput" type="text" placeholder="https://medbridgeglobal.net/" value="https://medbridgeglobal.net/">
            </label>
            <label class="field">
              <span>Repository URL</span>
              <input id="repoInput" type="text" placeholder="https://github.com/owner/repo" value="https://github.com/ShadowLKA/MedBridge">
            </label>
            <div class="row">
              <label class="field">
                <span>Branch</span>
                <input id="branchInput" type="text" placeholder="master" value="master">
              </label>
              <label class="field">
                <span>Commit message</span>
                <input id="messageInput" type="text" placeholder="Update content via editor" value="Update content via editor">
              </label>
            </div>
            <label class="field is-token">
              <span>GitHub token (PAT)</span>
              <input id="tokenInput" type="password" placeholder="Paste a token with contents write access">
            </label>
            <div class="actions">
              <button id="connectBtn" class="btn" type="button">Load site</button>
              <span id="connectBadge" class="badge">Not connected</span>
            </div>
            <p class="hint">Host this editor on the same GitHub Pages domain for full click-to-edit support.</p>
          </div>
        </section>

        <section class="panel" data-view-panel>
          <div class="panel-header">
            <h2>Views</h2>
          </div>
          <div class="panel-body">
            <div class="actions">
              <button id="viewEditorBtn" class="btn ghost is-active" type="button">Editor</button>
              <button id="viewConsultationsBtn" class="btn ghost" type="button">Consultations</button>
            </div>
          </div>
        </section><section class="panel is-hidden" data-admin-panel>
          <div class="panel-header">
            <h2>Admin tools</h2>
            <span class="status-chip" id="supabaseChip">Offline</span>
          </div>
          <div class="panel-body">
            <div class="stack">
              <label class="field is-hidden">
                <span>Supabase URL</span>
                <input id="supabaseUrlInput" type="text" placeholder="https://project.supabase.co">
              </label>
            <label class="field is-hidden">
              <span>Supabase anon key</span>
              <input id="supabaseKeyInput" type="password" placeholder="Anon key">
            </label>
            </div>
            <div class="actions">
              <span id="supabaseBadge" class="badge">Supabase offline</span>
            </div>
            <p id="supabaseStatus" class="status">Status: waiting for Supabase.</p>

            <details class="admin-section" data-team-admin-section>
              <summary>Team cards</summary>
              <div class="admin-body">
                <div id="teamAdminMessage" class="admin-message"></div>
                <form id="teamAdminForm" class="stack">
                  <input type="hidden" name="id">
                  <label class="field">
                    <span>Name</span>
                    <input type="text" name="name" placeholder="Jordan Lee" required>
                  </label>
                  <label class="field">
                    <span>Title</span>
                    <input type="text" name="title" placeholder="Senior Advisor" required>
                  </label>
                  <label class="field">
                    <span>Role</span>
                    <input type="text" name="role" placeholder="Operations" required>
                  </label>
                  <label class="field">
                    <span>Bio</span>
                    <textarea name="bio" rows="3" placeholder="Short bio" required></textarea>
                  </label>
                  <label class="field">
                    <span>Image upload</span>
                    <input type="file" name="image" accept="image/*">
                  </label>
                  <label class="field">
                    <span>Image URL (optional)</span>
                    <input type="text" name="image_url" placeholder="https://">
                  </label>
                  <div class="actions">
                    <button class="btn" type="submit">Save member</button>
                    <button class="btn ghost" type="button" id="teamAdminReset">New member</button>
                  </div>
                </form>
                <div id="teamAdminList" class="admin-list"></div>
              </div>
            </details>

            <details class="admin-section" data-news-admin-section>
              <summary>News photo slots</summary>
              <div class="admin-body" id="newsAdminBody">
                <div class="news-admin-slot" data-news-admin-slot data-slot="1">
                  <div class="news-admin-media">
                    <img class="is-hidden" data-slot-image alt="News slot 1">
                    <div class="news-admin-placeholder" data-slot-placeholder>Photo 1</div>
                  </div>
                  <label class="field">
                    <span>Caption</span>
                    <input type="text" data-slot-caption-input placeholder="Milestone event">
                  </label>
                  <label class="field">
                    <span>Replace image</span>
                    <input type="file" data-slot-file accept="image/*">
                  </label>
                  <div class="actions">
                    <button class="btn ghost" type="button" data-slot-clear>Clear</button>
                    <button class="btn" type="button" data-slot-save>Save</button>
                  </div>
                </div>
                <div class="news-admin-slot" data-news-admin-slot data-slot="2">
                  <div class="news-admin-media">
                    <img class="is-hidden" data-slot-image alt="News slot 2">
                    <div class="news-admin-placeholder" data-slot-placeholder>Photo 2</div>
                  </div>
                  <label class="field">
                    <span>Caption</span>
                    <input type="text" data-slot-caption-input placeholder="Milestone event">
                  </label>
                  <label class="field">
                    <span>Replace image</span>
                    <input type="file" data-slot-file accept="image/*">
                  </label>
                  <div class="actions">
                    <button class="btn ghost" type="button" data-slot-clear>Clear</button>
                    <button class="btn" type="button" data-slot-save>Save</button>
                  </div>
                </div>
                <div class="news-admin-slot" data-news-admin-slot data-slot="3">
                  <div class="news-admin-media">
                    <img class="is-hidden" data-slot-image alt="News slot 3">
                    <div class="news-admin-placeholder" data-slot-placeholder>Photo 3</div>
                  </div>
                  <label class="field">
                    <span>Caption</span>
                    <input type="text" data-slot-caption-input placeholder="Milestone event">
                  </label>
                  <label class="field">
                    <span>Replace image</span>
                    <input type="file" data-slot-file accept="image/*">
                  </label>
                  <div class="actions">
                    <button class="btn ghost" type="button" data-slot-clear>Clear</button>
                    <button class="btn" type="button" data-slot-save>Save</button>
                  </div>
                </div>
                <div id="newsAdminMessage" class="admin-message"></div>
              </div>
            </details>

            <details class="admin-section" data-service-admin-section>
              <summary>Service image slots</summary>
              <div class="admin-body" id="serviceAdminBody">
                <div class="admin-group">
                  <h4>Expert Second Opinion</h4>
                  <div class="service-admin-slot" data-service-admin-slot data-service-key="expert-second-opinion" data-slot="1">
                    <div class="service-admin-media">
                      <img class="is-hidden" data-slot-image alt="Expert Second Opinion slot 1">
                      <div class="service-admin-placeholder" data-slot-placeholder>Image slot 1</div>
                    </div>
                    <label class="field">
                      <span>Caption</span>
                      <input type="text" data-slot-caption-input placeholder="Add image caption">
                    </label>
                    <label class="field">
                      <span>Replace image</span>
                      <input type="file" data-slot-file accept="image/*">
                    </label>
                    <div class="actions">
                      <button class="btn ghost" type="button" data-slot-clear>Clear</button>
                      <button class="btn" type="button" data-slot-save>Save</button>
                    </div>
                  </div>
                  <div class="service-admin-slot" data-service-admin-slot data-service-key="expert-second-opinion" data-slot="2">
                    <div class="service-admin-media">
                      <img class="is-hidden" data-slot-image alt="Expert Second Opinion slot 2">
                      <div class="service-admin-placeholder" data-slot-placeholder>Image slot 2</div>
                    </div>
                    <label class="field">
                      <span>Caption</span>
                      <input type="text" data-slot-caption-input placeholder="Add image caption">
                    </label>
                    <label class="field">
                      <span>Replace image</span>
                      <input type="file" data-slot-file accept="image/*">
                    </label>
                    <div class="actions">
                      <button class="btn ghost" type="button" data-slot-clear>Clear</button>
                      <button class="btn" type="button" data-slot-save>Save</button>
                    </div>
                  </div>
                </div>

                <div class="admin-group">
                  <h4>Multi-Specialist Review</h4>
                  <div class="service-admin-slot" data-service-admin-slot data-service-key="multi-specialist-review" data-slot="1">
                    <div class="service-admin-media">
                      <img class="is-hidden" data-slot-image alt="Multi-Specialist Review slot 1">
                      <div class="service-admin-placeholder" data-slot-placeholder>Image slot 1</div>
                    </div>
                    <label class="field">
                      <span>Caption</span>
                      <input type="text" data-slot-caption-input placeholder="Add image caption">
                    </label>
                    <label class="field">
                      <span>Replace image</span>
                      <input type="file" data-slot-file accept="image/*">
                    </label>
                    <div class="actions">
                      <button class="btn ghost" type="button" data-slot-clear>Clear</button>
                      <button class="btn" type="button" data-slot-save>Save</button>
                    </div>
                  </div>
                  <div class="service-admin-slot" data-service-admin-slot data-service-key="multi-specialist-review" data-slot="2">
                    <div class="service-admin-media">
                      <img class="is-hidden" data-slot-image alt="Multi-Specialist Review slot 2">
                      <div class="service-admin-placeholder" data-slot-placeholder>Image slot 2</div>
                    </div>
                    <label class="field">
                      <span>Caption</span>
                      <input type="text" data-slot-caption-input placeholder="Add image caption">
                    </label>
                    <label class="field">
                      <span>Replace image</span>
                      <input type="file" data-slot-file accept="image/*">
                    </label>
                    <div class="actions">
                      <button class="btn ghost" type="button" data-slot-clear>Clear</button>
                      <button class="btn" type="button" data-slot-save>Save</button>
                    </div>
                  </div>
                </div>

                <div class="admin-group">
                  <h4>U.S. Visit Coordination</h4>
                  <div class="service-admin-slot" data-service-admin-slot data-service-key="us-visit-coordination" data-slot="1">
                    <div class="service-admin-media">
                      <img class="is-hidden" data-slot-image alt="U.S. Visit Coordination slot 1">
                      <div class="service-admin-placeholder" data-slot-placeholder>Image slot 1</div>
                    </div>
                    <label class="field">
                      <span>Caption</span>
                      <input type="text" data-slot-caption-input placeholder="Add image caption">
                    </label>
                    <label class="field">
                      <span>Replace image</span>
                      <input type="file" data-slot-file accept="image/*">
                    </label>
                    <div class="actions">
                      <button class="btn ghost" type="button" data-slot-clear>Clear</button>
                      <button class="btn" type="button" data-slot-save>Save</button>
                    </div>
                  </div>
                  <div class="service-admin-slot" data-service-admin-slot data-service-key="us-visit-coordination" data-slot="2">
                    <div class="service-admin-media">
                      <img class="is-hidden" data-slot-image alt="U.S. Visit Coordination slot 2">
                      <div class="service-admin-placeholder" data-slot-placeholder>Image slot 2</div>
                    </div>
                    <label class="field">
                      <span>Caption</span>
                      <input type="text" data-slot-caption-input placeholder="Add image caption">
                    </label>
                    <label class="field">
                      <span>Replace image</span>
                      <input type="file" data-slot-file accept="image/*">
                    </label>
                    <div class="actions">
                      <button class="btn ghost" type="button" data-slot-clear>Clear</button>
                      <button class="btn" type="button" data-slot-save>Save</button>
                    </div>
                  </div>
                </div>
                <div id="serviceAdminMessage" class="admin-message"></div>
              </div>
            </details>
          </div>
        </section>

        <section class="panel">
          <div class="panel-header">
            <h2>Edits to push</h2>
            <span class="status-chip" id="changesChip">Idle</span>
          </div>
          <div class="panel-body">
            <label class="field">
              <span>Replacement mode</span>
              <select id="replaceMode" disabled>
                <option value="all">Replace all occurrences</option>
                <option value="first">Replace first occurrence per file</option>
              </select>
            </label>
            <div class="actions">
              <button id="pushChangesBtn" class="btn" type="button" disabled>Push text edits</button>
              <button id="clearChangesBtn" class="btn ghost" type="button" disabled>Clear edits</button>
              <button id="saveDraftBtn" class="btn ghost" type="button" disabled>Save draft</button>
              <button id="loadDraftBtn" class="btn ghost" type="button" disabled>Load draft</button>
            </div>
            <div id="changesList" class="tiny">No edits yet.</div>
            <p id="status" class="status">Status: waiting for connection.</p>
          </div>
        </section>
      </aside>
    </main>
  </div>

  <div class="modal-backdrop" id="confirmModal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <h3 id="confirmTitle">Delete team member?</h3>
      <p id="confirmMessage">This action cannot be undone.</p>
      <div class="modal-actions">
        <button class="btn ghost" type="button" id="confirmCancel">Cancel</button>
        <button class="btn" type="button" id="confirmConfirm">Confirm</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script type="module" src="editor-app.js"></script>
</body>
</html>



